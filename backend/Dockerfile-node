# Usa un'immagine Node.js come base
FROM node:latest

# Crea e imposta la directory di lavoro nel contenitore
WORKDIR /usr/src/app

# Copia il backend
COPY backend/package*.json ./
RUN npm install
COPY backend ./

# Spostati nella cartella frontend
WORKDIR /usr/src/app/frontend

# Copia tutto il frontend, non solo package.json!
COPY frontend/package*.json ./
RUN npm install
COPY frontend ./

# Costruisci il frontend
RUN npm run build

# Torna alla root per eseguire il backend
WORKDIR /usr/src/app

# Esponi la porta del server
EXPOSE 3000

# Avvia il server quando il contenitore viene eseguito
CMD ["node", "index.js"]
